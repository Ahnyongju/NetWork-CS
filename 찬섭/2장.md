# 네트워크 연결과 구성 요소
## 2.1 네트워크 연결 구분
네트워크 규모와 관리 범위에 따라 LAN, MAN, WAN 3가지로 구분된다.


LAN:사용자 내부 네트워크


MAN:한 도시 정도를 연결하고 관리하는 네트워크


WAN:멀리 떨어진 LAN을 연결해주는 네트워크

LAN ==> MAN ==> WAN



### LAN
스위치와 같이 비교적 간단한 장비로 연결된 네트워크이다.
현재는 이더넷 기반 전송 기술을 사용한다.
LAN, WAN 등 대부분의 네트워크 환경에서 절대 다수를 차지하는 프로토콜이다.

[이더넷](https://namu.wiki/w/%EC%9D%B4%EB%8D%94%EB%84%B7):
1980년에 상용화 되었으니 꽤 오래된 방식이나 TCP/IP와 HTTP와 강하게 결합되어 현재도 건재하게 버티고 있다. 
유선 인터넷이 된다면 이는 곧 이더넷을 쓰는 환경이라고 생각하면 된다. IEEE 802.3 통신 규격이다.
OSI 모델에서는 이더넷은 L2 이하, 인터넷은 보통 L3 이상으로 분류하는데 이것을 이해한다면 더 정확하게 둘의 차이를 구분할 수 있다.

자신이 소유한 건물이나 대지에 직접 구축한 선로로 동작시키는 네트워크로 정의 가능.


### WAN
먼 거리에 있는 네트워크를 연결하기 위해 사용된다.

멀리 떨어진 LAN을 서로 연결하거나 인터넷에 접속하기 위한 네트워크가 WAN에 해당된다.

대부분 통신사업자(KT,LGU+,SKB)로부터 회선을 임대해서 사용한다.




## 2.2 네트워크 회선

### 인터넷 회선
인터넷 접속을 위해 통신사업자와 연결하는 회선을 인터넷 회선이라고 한다.

|종류|Mbps|
|:---|---:|
|광랜(이더넷)|기가 ~ 100Mbps|
|FTTH|기가 ~ 100Mbps|
|동축 케이블 인터넷|기가 ~ 100Mbps|
|xDSL(ADSL,VDSL 등)|기가 ~ 100Mbps|



### 전용 회선
가입자와 통신사업자 간에 대역폭을 보장해주는 서비스를 대부분 전용 회선이라고 한다.
대역폭을 보장해주는 기술에는 여러 가지가 있지만 가입자와 통신사업자 간에는 전용 케이블로 연결되어 있고 통신사업자 내부에서 TDM(시분할 다중화) 같은 기술로 마치 직접 연결한 것처럼 통신 품질을 보장해 준다.

전용 회선을 가입자와 접속하는 전송 기술을 기반으로 구분한다면 다음과 같이 음성 전송 기술 기반의 저속 회선과 메트로 이터넷이라는 고속 회선으로 분류할 수 있습니다.

 - 저속:음성 전송 기술 기반
   - 작은 기본 단위를 묶어 회선 접속 속도를 높이는 방법으로 높은 속도가 필요하지 않을 때나 높은 신뢰성이 필요할 때 사용되어 왔지만 현재 이더넷 기반의 광 전송 기술이 신뢰할 정도로 수준으로 올라와서 잘 사용하지 않는다.
   - 그렇지만 결재 승인과 같은 전문(CLEAR TEXT) 전송을 위한 VAN사나 대외 연결에는 저속 회선을 사용하는 경우가 많다.
   - 사용하기 위해서는 원격지 전송 기술로 변환할 수 있는 라우터가 필요하다.
 - 고속:메트로 이더넷
   - 광케이블 기반의 이더넷을 사용한다.
   - 가입자와 통신사업자 간의 접속 시술은 이더넷을 사용하고 통신사업자 내부에서는 이런 개별 가입자를 묶어 통신할 수 있는 다른 고속 통신 기술을 사용한다.



#### 참고
LLCF(Link Loss Carry Forward)
LLCF는 한쪽 링크가 다운되면 이를 감지해 반대쪽 링크도 다운시키는 기능이다.

전용회선을 이더넷으로 구성할 때 회선사에서 LLCF를 설정하지 않으면 전용 회선이 한 사이트에서 다운되더라도 반대쪽 사이트에서는 회선이 그대로 살아있는 것처럼 보이므로 반드시 회선 개통 후 회선사사에서 LLCF 설정이 되어 있는지 확인해야ㅑ 합니다.

저속 회선은 2계층 프로토콜 통신 상태를 확인하는 기능이 있으므로 라우터에서 상대방 링크가 끊길 경우, 감지할 수 있어 LLCF 설정이 별도로 필요없습니다.

왜 사용하는가?

위, 아래 link 중 어느 하나가 끊어지면(down state) 나머지 하나의 link도 끊어서 위, 아래 위치된 장비의 경로 설정을 변경(Failover)할 수 있도록 해주는 네트워크 기술이다.

아래 그림과 같이 LLCF 설정이 되어있지 않은 상태로 방화벽 상단 switch와의 link가 down될 경우, 하단 switch는 상단의 상황을 알지 못하기 때문에 끊긴 link로 통신을 시도하게 되고 통신 장애가 발생하게 된다.
<p align="center">
 <img src="https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/947833a7-c4ef-4d3d-a993-e5e8f2f68677">
 
</p>


만약 아래 그림과 같이 LLCF 설정이 완료된 상태로 방화벽 상단 switch와의 link가 down될 경우, 하단 switch와의 link도 down 시킨다.

그러면, 하단 switch에서는 link가 down된 것을 알 수 있기 때문에 라우팅 경로를 변경하여 통신을 지속할 수 있게된다.
<p align="center">
 <img src="https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/76ac894a-920c-407b-94cd-ae936f4ace04">
</p>



## 인터넷 전용 회선
인터넷 연결 회선에 대한 통신 대역폭을 보장해주는 상품을 인터넷 전용 회선이라고 한다.
인터넷 전용 회선은 가입자가 일반가정에서 사용하는 접속 기술과 달리 다른 가입자와 경쟁하지 않고 통신사업자와 가입자 간의 연결 품질을 보장해줍니다.



## VPN
VPN은 Virtual Private Network의 약자로 물리적으로는 전용선이 아니지만 가상으로 직접 연결한 것 같은 효과가 나도록 만들어주는 네트워크 기술이다.
[VPN](https://namu.wiki/w/%EA%B0%80%EC%83%81%20%EC%82%AC%EC%84%A4%EB%A7%9D)




### 통신사업자 VPN
전용선은 연결 거리가 늘어날수록 비용이 증가한다.

전용선은 사용 가능한 대역폭을 보장해주지만 가입자가 계약된 대역폭을 항상 100% 사용하는 것이 아니어서 낭비되는 비용이 클 수 있다.

이런 비용 낭비를 줄이고 먼 거리와 연결하더라도 비용을 줄이기 위해 통신사업자가 직접 가입자를 구분할 수 있는 VPN 기술을 사용해 비용을 낮추고 있다.

대표적을 MPLS VPN이 있다.
#### MPLS VPN
여러 가입자가 하나의 MPLS 망에 접속되지만 가입자를 구분할 수 있는 기술을 적용해 전용선처럼 사용 할 수 있다.
![KakaoTalk_20230828_202727909](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/f2897fbd-e0fd-4e65-bcdd-9ca3379ea371)




## 네트워크 구성 요소
OSI 7계층
![image](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/3915082b-0992-4929-bb3a-ec6f4f6f8686)




### 허브
허브는 케이블과 동일한 1계층에서 동작하는 장비이다.

허브는 거리가 멀어질수록 줄어드는 전기 신호를 재생성해주고 HUB라는 용어 그대로 여러 대의 장비를 연결할 목적으로 사용된다.

허브는 단순히 들어온 신호를 모든 포트로 내보내 네트워크에 접속된 모든 단말이 경쟁하게 되므로 전체 네트워크 성능이 줄어드는 문제가 있고 패킷이 무한 순환해 네트워크 전체를 마비시키는 루프와 같은 다양한 장애의 원인이 되어 허브는 현재 거의 사용되지 않고 있다.




### 스위치
스위치는 허브와 동일하게 여러 장비를 연결하고 통신을 중재하는 2계층 장비이다.

허브와 스위치는 내부 동작 방식은 다르지만 여러 장비를 연결하고 케이블을 한곳으로 모아주는 역활은 같으므로 '허브'라는 용어를 공통적으로 사용한다.

스위치는 허브의 역할과 통신을 중재하는 2가지 역할을 모두 포함하므로 스위치 허브라고도 불린다.

허브는 단순히 전기 신호를 재생성해 출발지를 제외한 모든 포트에 전기 신호를 내보내지만 스위치는 허브와 달리 MAC 주소를 이해할수 있어 목적지 MAC 주소의 위치를 파악하고 목적지가 연결된 포트로만 전기 신호를 보낸다.




### 라우터
네트워크 크기가 커지고 먼 지역에 위치한 네트워크와 통신해야 하는 요구사항이 늘어나면서 라우터가 필요해졌습니다.

3계층에서 동작하면서 먼 거리로 통신할 수 있는 프로토콜로 변환한다.

라우터는 원격지로 쓸데없는 패킷이 전송되지 않도록 브로드캐스트와 멀티캐스트를 컨트롤하고 불분명한 주소로 통신을 시도할 경우, 이를 버린다.

정확한 방향으로 패킷이 전송되도록 경로를 지정하고 최적의 경로로 패킷을 포워딩 한다.

최근에는 유사한 기능으로 L3 스위치와 공유기는 찾아볼 수 있다.


### 로드 밸런서
OSI 7계층 중 4계층에서 동작한다.

애플리케이션 계층에서 애플리케이션 프로토콜의 특징을 이해하고 동작하는 7계층 로드 밸런서를 별도로 ADC(Application Delivery Controller)라고 부른다.

L4 스위치라고 부르는 네트워크 장비도 로드 밸랜서의 한 종류로, 스위치처럼 여로 포트를 가지고 있으면서 로드 밸런서 역할을 하는 장비를 지칭합니다.

#### 동작방식
서버가 단 하나만 존재할 때, 수천만 명의 사람들이 서버에 동시 접속하면 서버는 부하를 감당하지 못할 수 있다. 이를 해결하는 방식에는 서버의 성능을 높이는 Scale-up 방식과 여러 서버는 두는 Scale-out 방식이 있다. 대부분의 서비스는 서버의 성능을 높이는 Scale-up 작업은 한계가 있으므로 분산 처리를 위해 여러 대의 서버를 두는 Scale-out 작업을 하게 되는데, 이때 여러 서버들로 대규모의 네트워크 트래픽을 분산 처리하는 기술을 로드 밸런싱 (Load Balancing)이라고 한다.
![image](https://github.com/ssg-cs-study/NetWork-CS/assets/99310356/010c52f4-55c5-4fe6-b4f4-913a957c427a)

로드 밸런싱은 네트워크 또는 서버에 가해지는 부하를 분산해 주는 기술을 의미한다. 로드 밸런싱 기술을 제공하는 서비스 또는 장치를 로드 밸런서 (LB, Load Balancer)라고 부른다. LB는 클라이언트와 네트워크 트래픽이 집중되는 서버들 사이에 위치하며 VIP (Virtual IP)와 함께 구성된다. 또한, 특정 서버에 부하가 집중되지 않도록 트래픽을 다양한 방법으로 분산하여 서버들의 성능을 최적인 상태로 유지할 수 있도록 한다.

#### VIP란?
VIP란 로드 밸런싱의 대상이 되는 여러 서버를 대표하는 가상의 IP이다. 클라이언트들은 서버의 IP로 직접 요청을 하는 것이 아니라 LB가 가지고 있는 VIP를 대상으로 요청한다. 그리고 LB는 설정된 부하 분산 방법에 따라 각 서버로 요청을 분산한다.



### 보안장비(방화벽/IPS)
대부분의 네트워크 장비는 정확한 정보 전달에 초점이 맞추어져 있지만 보안 장비는 네트워크 장비와 달리 정보를 잘 제어하고 공격을 방어하는 데 초점이 맞추어져 있다.

방어 목적과 보안 장비가 설치되는 위치에 맞추어 다양한 보안 장비가 사용된다.

일반적으로 가장 유명한 보안 장비는 방화벽이다.

방화벽은 OSI7계층 중 4계층에서 동작해 방화벽을 통과하는 패킷의 3,4계층 정보를 확인하고 패킷을 정책과 비교해 버리거나 포워딩한다.
